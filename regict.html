<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Регистрация</title>
    <link rel="stylesheet" href="style..css" />
  </head>

  <body>
    <div class="reg">
      <h1 class="h1">Qualimeter</h1>
      <img src="img/cropped-image (6).svg" alt="" class="imgreg" />
      <img src="img/cropped-image (7).svg" alt="" class="imgreg1" />
      <img src="img/cropped-image (8).svg" alt="" class="imgreg2" />
      <div class="regpan">
        <form id="regForm">
          <div class="h2">
            <h2 class="h22">Регистрация</h2>
          </div>
          <p class="p1">Создайте свою учетную запись</p>

          <div class="switch-buttons">
            <button
              type="button"
              class="switch-btn active"
              data-value="employee"
            >
              Сотрудник
            </button>
            <button type="button" class="switch-btn" data-value="company">
              Компания
            </button>
          </div>
          <div class="col1">
            <p class="p2">Имя</p>
            <input
              type="text"
              id="username"
              name="username"
              placeholder="  Никита Никитин"
              class="us"
              required
            /><br /><br />
          </div>
          <div class="col3">
            <p class="p4">Логин</p>
            <input
              type="text"
              id="login"
              name="login"
              class="lg"
              required
            /><br /><br />
          </div>
          <div class="col4">
            <p class="p5">Email</p>
            <input
              type="email"
              id="email"
              name="email"
              placeholder="  your@email.com"
              class="el"
              required
            /><br /><br />
          </div>
          <div class="col5">
            <p class="p6">Пароль</p>
            <input
              type="password"
              id="password"
              name="password"
              placeholder="  ********"
              class="pass"
              required
            /><br /><br />
          </div>
          <a href="prof.html"><button type="submit" class="btn">Зарегистрироваться</button></a>

          <div class="dv">
            <p>Уже есть аккаунт?</p>
            <a href="enter.html">Войти</a>
            <img src="img/Line 1.svg" alt="" />
          </div>
        </form>
      </div>
    </div>
    <script>
      // ДОБАВЛЕНО: Инициализация переключения между кнопками
      document.addEventListener("DOMContentLoaded", function () {
        const switchButtons = document.querySelectorAll('.switch-btn');
        const usernameInput = document.getElementById('username'); // ДОБАВЛЕНО: получаем поле ввода имени
        let currentRole = 'employee'; // значение по умолчанию

        // Функция для обновления placeholder в зависимости от роли
        function updatePlaceholder(role) {
          if (role === 'company') {
            usernameInput.placeholder = "  ООО \"Компания\""; // ДОБАВЛЕНО: меняем placeholder для компании
          } else {
            usernameInput.placeholder = "  Никита Никитин"; // ДОБАВЛЕНО: возвращаем placeholder для сотрудника
          }
        }

        // Обработчик для кнопок переключения
        switchButtons.forEach(button => {
          button.addEventListener('click', function() {
            // Убираем активный класс у всех кнопок
            switchButtons.forEach(btn => btn.classList.remove('active'));
            
            // Добавляем активный класс текущей кнопке
            this.classList.add('active');
            
            // Сохраняем выбранную роль
            currentRole = this.getAttribute('data-value');
            
            // ДОБАВЛЕНО: Обновляем placeholder поля ввода имени
            updatePlaceholder(currentRole);
            
            console.log('Выбрана роль:', currentRole); // для отладки
          });
        });

        // ИСПРАВЛЕНО: Добавлено объявление переменной form
        const form = document.getElementById("regForm");

        form.addEventListener("submit", async function (e) {
          e.preventDefault();

          const formData = {
            username: document.getElementById("username").value,
            login: document.getElementById("login").value,
            email: document.getElementById("email").value,
            password: document.getElementById("password").value,
            role: currentRole, // ДОБАВЛЕНО: используем сохраненную роль
          };

          // Получаем текущий список пользователей из localStorage
          let users = JSON.parse(localStorage.getItem("users")) || [];

          // Проверяем, нет ли уже пользователя с таким email
          const existingUser = users.find(
            (user) => user.email === formData.email
          );
          if (existingUser) {
            alert("Пользователь с таким email уже зарегистрирован");
            return;
          }

          // Добавляем нового пользователя
          users.push(formData);

          // Сохраняем обратно в localStorage
          localStorage.setItem("users", JSON.stringify(users));

          alert("Регистрация успешна!");
          window.location.href = "enter.html";
        });
      });
    </script>
  </body>
</html>
<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8" />
  <meta name="theme-color" content="#155DFC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="format-detection" content="telephone=no">
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>Компетенции - Qualimeter</title>
  <!-- Подключаем общие стили из style1.css -->
  <link rel="stylesheet" href="style1.css" />
  <!-- Подключаем стили только для контента страницы -->
  <link rel="stylesheet" href="more.css" />
</head>

<body>
  <script>
    // Проверяем, вошел ли пользователь
    const currentUser = localStorage.getItem('currentUser');
    if (!currentUser) {
      alert('Пожалуйста, войдите в систему');
      window.location.href = 'enter.html';
    }
  </script>
  
  <div class="prof1">
    <!-- Навигация из style1.css -->
    <div class="nav">
      <div class="logo">
        <h1 class="h1">Qualimeter</h1>
      </div>
      <div class="part2">
        <div class="a1">
          <a href="#">Тесты</a>
        </div>
        <div class="a2">
          <a href="#">План развития</a>
        </div>
        <div class="a3">
          <a href="#">Повышение</a>
        </div>
        <div class="a4">
          <a href="company.html">Компания</a>
        </div>
      </div>
      <div class="part3" id="userMenu">
        <img src="img/imgprof/user-account_9327873 1 (1).svg" alt="user" class="user-icon" />
        <p id="userMenuName">Загрузка...</p>
        <img src="img/imgprof/Vector 1.svg" alt="arrow" class="arrow-icon" />
      </div>
      <div class="dropdown-menu" id="dropdownMenu">
        <div class="menu-section">
          <div class="menu-item-with-icon">
            <img src="img/imgprof/person.svg" alt="" class="menu-icon" />
            <a href="prof.html" class="menu-link main-link">Профиль</a>
          </div>
          <div class="menu-item-with-icon">
            <img src="img/imgprof/settings.svg" alt="" class="menu-icon" />
            <a href="#" class="menu-link">Настройки</a>
          </div>
          <div class="menu-item-with-icon">
            <img src="img/imgprof/notifications_unread.svg" alt="" class="menu-icon" />
            <a href="#" class="menu-link">Уведомления</a>
          </div>
          <div class="menu-item-with-icon logout">
            <img src="img/imgprof/logout.svg" alt="" class="menu-icon" />
            <a href="profend.html" class="menu-link">Выйти</a>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Декоративные изображения -->
    <img src="img/imgprof/blending 1754474870 (1).svg" alt="" class="imgreg" />
    <img src="img/imgprof/blending 1762691066228 (1).svg" alt="" class="imgreg1" />
    <img src="img/imgprof/blending 1754474869 (1).svg" alt="" class="imgreg2" />
    
    <!-- Контент страницы -->
    <div class="more-content">
      <div class="quali">
        <h2>Ваши компетенции</h2>
        <div>
          <div class="comp1">
            <p>Senior Python разработчик</p>
          </div>
          <div class="comp2">
            <p>Работа с ООП ( Продвинутый )</p>
          </div>
          <div class="comp3">
            <p>Алгоритмы и структуры данных ( Средний )</p>
          </div>
          <div class="comp4">
            <p>Математическая статистика ( Базовый )</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Функция для загрузки данных пользователя
    function loadUserData() {
      try {
        const userDataStr = localStorage.getItem('currentUser');

        if (!userDataStr) {
          console.error('Данные пользователя не найдены');
          return;
        }

        const userData = JSON.parse(userDataStr);

        let firstName = '';
        let lastName = '';

        if (userData.name) {
          firstName = userData.name;
        } else if (userData.firstName) {
          firstName = userData.firstName;
        } else if (userData.username) {
          firstName = userData.username;
        }

        if (userData.lastname) {
          lastName = userData.lastname;
        } else if (userData.lastName) {
          lastName = userData.lastName;
        }

        if (userData.name && userData.name.includes(' ')) {
          const nameParts = userData.name.split(' ');
          firstName = nameParts[0] || firstName;
          lastName = nameParts.slice(1).join(' ') || lastName;
        }

        // Короткое имя для меню
        let shortName = firstName;
        if (lastName) {
          const lastNameInitial = lastName.charAt(0);
          shortName += ' ' + lastNameInitial + '.';
        }

        document.getElementById('userMenuName').textContent = shortName;

      } catch (error) {
        console.error('Ошибка при загрузке данных пользователя:', error);
        document.getElementById('userMenuName').textContent = 'Пользователь';
      }
    }

    // Настройка меню
    document.addEventListener("DOMContentLoaded", function () {
      loadUserData();

      const userMenu = document.getElementById("userMenu");
      const dropdownMenu = document.getElementById("dropdownMenu");

      function toggleMenu(e) {
        e.preventDefault();
        e.stopPropagation();
        dropdownMenu.classList.toggle("active");
        userMenu.classList.toggle("active");
      }

      userMenu.addEventListener("click", toggleMenu);
      userMenu.addEventListener("touchstart", toggleMenu);

      function closeMenu() {
        dropdownMenu.classList.remove("active");
        userMenu.classList.remove("active");
      }

      document.addEventListener("click", closeMenu);
      document.addEventListener("touchstart", closeMenu);

      dropdownMenu.addEventListener("click", function (e) {
        e.stopPropagation();
      });
      dropdownMenu.addEventListener("touchstart", function (e) {
        e.stopPropagation();
      });
    });
  </script>
</body>

</html>